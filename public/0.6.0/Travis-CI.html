<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Testacular</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Le styles -->
    <link href="../assets/css/app.css" rel="stylesheet">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements --><!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
    <link rel="shortcut icon" href="../assets/ico/favicon.png">
  </head>
  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid"><a data-toggle="collapse" data-target=".nav-collapse" class="btn btn-navbar"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a href="index.html" class="brand">Testacular</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">about<b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="Changelog.html">Changelog</a></li>
                  <li><a href="Versioning.html">Versioning</a></li>
                  <li><a href="Who.html">Who</a></li>
                </ul>
              </li>
              <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">config<b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="Browsers.html">Browsers</a></li>
                  <li><a href="CoffeeScript.html">CoffeeScript</a></li>
                  <li><a href="Configuration-File-Overview.html">Configuration-File-Overview</a></li>
                  <li><a href="Coverage-Reporter.html">Coverage-Reporter</a></li>
                  <li><a href="Files.html">Files</a></li>
                  <li><a href="Preprocessors.html">Preprocessors</a></li>
                </ul>
              </li>
              <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">dev<b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="Client---server-protocol.html">Client---server-protocol</a></li>
                  <li><a href="Events.html">Events</a></li>
                  <li><a href="How-to-contribute.html">How-to-contribute</a></li>
                  <li><a href="Public-apis.html">Public-apis</a></li>
                  <li><a href="Todos.html">Todos</a></li>
                </ul>
              </li>
              <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">intro<b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="Getting-Started.html">Getting-Started</a></li>
                  <li><a href="Troubleshooting.html">Troubleshooting</a></li>
                  <li><a href="Why?.html">Why?</a></li>
                </ul>
              </li>
              <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">plus<b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="Jenkins-CI.html">Jenkins-CI</a></li>
                  <li><a href="RequireJS.html">RequireJS</a></li>
                  <li><a href="Teamcity.html">Teamcity</a></li>
                  <li><a href="Travis-CI.html">Travis-CI</a></li>
                </ul>
              </li>
            </ul>
            <ul class="nav">
              <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">v0.6.0<b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="../0.6.0/index.html">0.6.0</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
          <div class="well sidebar-nav">
            <ul class="nav nav-list">
              <li class="nav-header">Travis CI Integration
                <li><a href="#setup">Setup</a></li>
                <li><a href="#notes">Notes</a></li></li>
            </ul>
          </div>
        </div>
        <div class="span9">
          <div class="row-fluid">
            <h1>Travis CI Integration</h1>
            <div id="content"><p><a href="https://travis-ci.org/">Travis CI</a> is a popular continuous integration service that integrates with your <a href="https://github.com/">Github</a> repository to automatically run your tests when code is pushed. Integration is done by adding a simple <a href="http://www.yaml.org/">YAML</a> file to your project root; Travis and Github take care of the rest. Travis results will appear in your Github pull requests and your history is available on their control panel. This article assumes you already have Travis account.</p>
<h2 id='setup'><a class='heading_anchor' href='#setup'><i class='headerLinkIcon'></i></a>Setup</h2>
<ol>
<li><p>Create a file in your project root called <code>.travis.yml</code> with the following YAML:</p>
<pre><code><span class="title">language</span>: node_js
<span class="title">node_js</span>:
  - <span class="number">0.8</span></code></pre>
</li>
<li><p>If you do not already have a <code>package.json</code> in your project root create one now. Travis runs <code>npm test</code> to trigger your tests so this is where you tell Travis how to run your tests. </p>
<pre><code class="language-javascript"><span class="comment">// ...snip...</span>
<span class="string">"dependencies"</span>: {
   <span class="string">"coffee-script"</span>: <span class="string">"1.4.x"</span>
},
<span class="string">"devDependencies"</span>: {
  <span class="string">"testacular"</span>: <span class="string">"0.4.x"</span>,
  <span class="string">"phantomjs"</span>: <span class="string">"0.2.x"</span> 
},
<span class="comment">// ...snip...</span>
<span class="string">"scripts"</span>: {
    <span class="string">"test"</span>: <span class="string">"./node_modules/coffee-script/bin/cake test"</span>
}
<span class="comment">// ...snip...</span></code></pre>
<p>Travis will run <code>npm install</code> before every suite so this is your chance to specify any modules your app needs that Travis does not â€“ like Testacular.</p>
<p>This example uses a <a href="http://coffeescript.org/documentation/docs/cake.html">Cake</a> task to run a suite of tests but you can fire off any executable task in the <code>test</code> field. Note that the <a href="http://about.travis-ci.org/docs/user/ci-environment/">Travis environment</a> doesn&#39;t have <a href="http://coffeescript.org/">CoffeeScript</a> available globally so you must point to your module&#39;s Cake bin.</p>
</li>
<li><p>Now it&#39;s time to open (or create) <code>Cakefile</code> in your project root and add a task to run Testacular. This creates a way to fire your Testacular suite for a single run which can be used any place or time.</p>
<pre><code class="language-coffeescript">task <span class="string">'test'</span>, <span class="string">'run all tests suites'</span>, ->
console.log <span class="string">'Running front-end tests'</span>
  phantom_bin = <span class="string">"PHANTOMJS_BIN=<span class="subst">#{__dirname}</span>/node_modules/phantomjs/lib/phantom/bin/phantomjs"</span>
  testacular = <span class="string">"<span class="subst">#{__dirname}</span>/node_modules/testacular/bin/testacular"</span>
  browsers = <span class="keyword">if</span> process.env.TRAVIS then <span class="string">'PhantomJS'</span> <span class="keyword">else</span> <span class="string">'PhantomJS,Chrome'</span>
  options = <span class="string">"--single-run --browsers=<span class="subst">#{browsers}</span>"</span>
  exec <span class="string">"<span class="subst">#{phantom_bin}</span> <span class="subst">#{testacular}</span> start <span class="subst">#{__dirname}</span>/tests/testacular.conf.js <span class="subst">#{options}</span>"</span>, (err, stdout, stderr) ->
    console.error err <span class="keyword">if</span> err
    console.log stdout</code></pre>
<p>While Travis does have <a href="http://phantomjs.org/">PhantomJS</a> available in its global root, other CI environments or developers may not so it&#39;s a good idea to make sure it&#39;s explicitly set before running Testacular.</p>
<p>Also note that while you can run <a href="http://about.travis-ci.org/docs/user/gui-and-headless-browsers/">GUI apps</a> in Travis their configuration is beyond this article so the script checks that it&#39;s in a Travis environment and sets the browser list to only use PhantomJS.</p>
<p>Once all configuration is set Testacular is fired off, assuming your Testacular configuration is in <code>#{__dirname}/tests/testacular.conf.js</code>. If any errors or encountered they - and the standard logs - are displayed in the Travis control panel.</p>
</li>
<li><p>All that&#39;s left is to test the Cake task locally to assure it works as advertised, commit the files, push them to Github.</p>
</li>
</ol>
<h2 id='notes'><a class='heading_anchor' href='#notes'><i class='headerLinkIcon'></i></a>Notes</h2>
<ul>
<li>Travis&#39; Node environment has very little available. If the startup process in Travis fails check for missing module information and be sure to add them to your <code>package.json</code> dependencies.</li>
<li>Travis does not run in your local network so any code that attempts to connect to resources should be stubbed out using <a href="https://github.com/flatiron/nock">Nock</a>.</li>
<li>There are more options available to your <code>.travis.yml</code>, such as running scripts before the install or test run. There are hints in the Travis docs for <a href="http://about.travis-ci.org/docs/user/gui-and-headless-browsers/">GUI apps</a> configuration.</li>
</ul>
</div>
          </div>
        </div>
      </div>
      <hr>
      <footer>
        <ul>
          <li><a href="https://github.com/vojtajina">Testacular by Vojta Jina</a></li>
          <li><a href="https://github.com/Dignifiedquire">Site by Friedel Ziegelmayer</a></li>
        </ul>
      </footer>
    </div>
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/js/jquery.js"></script>
    <script src="../assets/js/bootstrap.min.js"></script>
  </body>
</html>